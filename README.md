Kind of experimented with recursion on this one so forgive the messiness
